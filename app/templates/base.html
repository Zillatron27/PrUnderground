<!DOCTYPE html>
<html lang="en" class="{{ display_classes|default('') }}" data-theme="refined-prun">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - PrUnderground</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/css/style.css?v={{ static_version('css/style.css') }}">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
        // Apply theme and tile style from localStorage before page renders (prevents flash)
        (function() {
            var theme = localStorage.getItem('pru-theme') || 'refined-prun';
            document.documentElement.setAttribute('data-theme', theme);
            var tileStyle = localStorage.getItem('pru-tile-style') || 'filled';
            document.documentElement.setAttribute('data-tile-style', tileStyle);
        })();
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <div class="spinner-data" id="global-spinner"></div>
            <a href="/" class="nav-logo">PrUnderground</a>
        </div>

        <!-- Hamburger toggle (CSS-only, hidden on desktop) -->
        <input type="checkbox" id="nav-toggle" class="nav-toggle-input" aria-label="Toggle navigation">
        <label for="nav-toggle" class="nav-toggle-label" aria-hidden="true">
            <span class="hamburger-icon"></span>
        </label>

        <div class="nav-links">
            {% if current_user %}
                <a href="/dashboard">Dashboard</a>
            {% endif %}
            <a href="/listings">Browse</a>
            {% if current_user %}
                <a href="/u/{{ current_user.fio_username }}">Profile</a>
                <a href="/auth/account">Account</a>
                {% if is_admin(current_user) %}
                <a href="/admin/stats" class="nav-admin">Admin</a>
                {% endif %}
                <a href="/auth/logout">Logout</a>
            {% else %}
                <a href="/auth/login">Login</a>
            {% endif %}
        </div>
    </nav>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    {% if chrome_visible|default(true) %}
    <footer class="footer">
        <p>PrUnderground v{{ app_version }} · <a href="https://github.com/Zillatron27/PrUnderground">GitHub</a> · <a href="/about">About</a></p>
    </footer>
    {% endif %}

    <script src="/static/js/app.js?v={{ static_version('js/app.js') }}"></script>
</body>
</html>
